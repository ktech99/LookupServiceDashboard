{"ast":null,"code":"'use strict';\n\nconst _require = require('stream'),\n      PassThroughStream = _require.PassThrough;\n\nconst zlib = require('zlib');\n\nconst mimicResponse = require('mimic-response');\n\nconst decompressResponse = response => {\n  const contentEncoding = (response.headers['content-encoding'] || '').toLowerCase();\n\n  if (!['gzip', 'deflate', 'br'].includes(contentEncoding)) {\n    return response;\n  }\n\n  const isBrotli = contentEncoding === 'br';\n\n  if (isBrotli && typeof zlib.createBrotliDecompress !== 'function') {\n    return response;\n  }\n\n  const decompress = isBrotli ? zlib.createBrotliDecompress() : zlib.createUnzip();\n  const stream = new PassThroughStream();\n  mimicResponse(response, stream);\n  decompress.on('error', error => {\n    // Ignore empty response\n    if (error.code === 'Z_BUF_ERROR') {\n      stream.end();\n      return;\n    }\n\n    stream.emit('error', error);\n  });\n  response.pipe(decompress).pipe(stream);\n  return stream;\n};\n\nmodule.exports = decompressResponse; // TODO: remove this in the next major version\n\nmodule.exports.default = decompressResponse;","map":null,"metadata":{},"sourceType":"script"}